### Cardiac-SPECT-Images-Unet-Segmentation-Various-Architectures
# This repository contains:
1- Training codes for all U-Net model for the first dataset (Spect_UNet_Segmentation_5Models_Ensemble_First_Dataset_With_Statistics.ipynb)
2- Training codes for all U-Net model for the second dataset (Spect_UNet_Segmentation_5Models_Ensemble_Second_Dataset_With_Statistics (1).ipynb)
3- One of our trained models: Unet-VGGATT_Ahmad.pt
4- The codes required to create the DICOM file using the trained model and input source
5- Example of the source and output of our implemetnation in a .zip format.
6- Examples of our output DICOM files produced by different models (SPECT FINAL IMAGES 5 by 5 filter all models.rar)
7- Dataset (contains two subfolders one for images and another one for masks)

### Now for producing the segmented DICOM file using our trained models, you need to follow the following instructions:
1- you need to extract all SPECT file images using the SPECT_Heart_ROI_Segmenter_V5_Final
just upload the 'SGATE_G_1001_DS (original).dcm' file and press 'c' letters until finishing
all slices so you will get all slices of this file
2- Move all resulted images to the folder 'source'
3- open the file 'Segmentation_Spect_Reconstruction.py' which will use the U-net model to segment 
all slices of 'source' folder and save the results (segmentation masks) in folder 'output'.
so first modify the paths:
folder_path = 'C:/Users/admin/Desktop/Spect Final Segmentation Evalaution code/source'
mask_folder_path = 'C:/Users/admin/Desktop/Spect Final Segmentation Evalaution code/output/'
according to your paths.
4- Run the file 'Segmentation_Spect_Reconstruction.py'
5- Go to folder 'output' and you will find the segmented images using the masks generated by U-net
6- Run 'Create_New_Segmented_Dicom_File.py' to create the new segmented dicom file (change paths as yours)
7- Run 'Cretae the segmented new SPECT DICOM file' to create the final segmented DICOM file.
8- Run 'Copy_Meta_data.py' to ensure that the new gengerated file contains the original meta data.

FINISH
Now the dicom file is ready with name 'SGATE_G_1001_DS_N.dcm'
don't forget to upload the Unet model to the same folder path




